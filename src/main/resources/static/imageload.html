<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>디자이너 포트폴리오 미디어</title>
</head>
<body>
<h2>디자이너 포트폴리오</h2>

<input type="text" id="designerId" placeholder="디자이너 ID 입력">
<button onclick="loadMedia()">미디어 불러오기</button>

<h3>포트폴리오 미디어:</h3>
<div id="mediaContainer"></div>

<script>
    async function loadMedia() {
        const designerId = document.getElementById("designerId").value;
        const mediaContainer = document.getElementById("mediaContainer");
        mediaContainer.innerHTML = ""; // 기존 미디어 초기화

        if (!designerId) {
            alert("디자이너 ID를 입력하세요.");
            return;
        }

        try {
            // 1. 디자이너의 모든 파일 ID 가져오기
            const response = await fetch(`https://blaybus-glowup.com/designers/portfolio/list?designerId=${designerId}`);
            if (!response.ok) {
                throw new Error("디자이너의 포트폴리오를 찾을 수 없습니다.");
            }
            const mediaIds = await response.json();

            // 2. 각 ObjectId를 이용해 개별 미디어 가져와 화면에 표시
            mediaIds.forEach((id) => {
                const mediaElement = document.createElement("img"); // 기본값: 이미지

                // 이미지인지 비디오인지 알 수 없으므로 둘 다 시도
                mediaElement.src = `https://blaybus-glowup.com/designers/portfolio/load?objectId=${id}`;
                mediaElement.style.maxWidth = "300px";
                mediaElement.style.margin = "10px";

                mediaElement.onerror = () => { // 이미지가 아니면 비디오로 변경
                    mediaElement.remove();
                    const video = document.createElement("video");
                    video.src = `https://blaybus-glowup.com/designers/portfolio/load?objectId=${id}`;
                    video.width = 300;
                    video.controls = true;
                    video.style.margin = "10px";
                    mediaContainer.appendChild(video);
                };

                mediaContainer.appendChild(mediaElement);
            });
        } catch (error) {
            console.error("미디어 불러오기 오류:", error);
            alert("미디어 불러오기에 실패했습니다.");
        }
    }
</script>
</body>
</html>